# Windows Task Scheduler 자동 시작 설정 가이드

## 개요
이 가이드는 Windows 부팅 시 자동으로 주식 모니터링 서비스를 시작하는 방법을 설명합니다.

## 방법 1: Windows 작업 스케줄러 사용 (권장)

### 1단계: 작업 스케줄러 열기
1. `Win + R` 키를 눌러 실행 창을 엽니다
2. `taskschd.msc`를 입력하고 Enter를 누릅니다

### 2단계: 새 작업 만들기
1. 오른쪽 패널에서 **"작업 만들기..."** 클릭
2. **일반** 탭:
   - 이름: `Stock Bot Monitor`
   - 설명: `Premium Quant Dashboard 백그라운드 모니터링`
   - **"사용자가 로그온할 때만 실행"** 선택
   - **"가장 높은 수준의 권한으로 실행"** 체크

### 3단계: 트리거 설정
1. **트리거** 탭으로 이동
2. **"새로 만들기..."** 클릭
3. 다음 설정:
   - 작업 시작: **"로그온할 때"**
   - 설정: **"특정 사용자"** (현재 사용자 선택)
   - 고급 설정에서 **"작업 지연 시간"**: 30초
   - **"사용"** 체크
4. **확인** 클릭

### 4단계: 동작 설정
1. **동작** 탭으로 이동
2. **"새로 만들기..."** 클릭
3. 다음 설정:
   - 동작: **"프로그램 시작"**
   - 프로그램/스크립트: `node`
   - 인수 추가: `scripts\monitor.js`
   - 시작 위치: `c:\Users\abyz\OneDrive\바탕 화면\프로젝트\2026년\1.STOCK BOT`
4. **확인** 클릭

### 5단계: 조건 설정
1. **조건** 탭으로 이동
2. 다음 설정 해제:
   - ❌ "컴퓨터의 전원이 AC 전원일 때만 작업 시작"
   - ❌ "컴퓨터가 유휴 상태일 때만 작업 시작"

### 6단계: 설정 구성
1. **설정** 탭으로 이동
2. 다음 설정:
   - ✅ "작업이 실패하면 다시 시작 간격": 1분
   - ✅ "작업을 중지할 수 없으면 강제로 중지"
   - ✅ "작업이 요청 시 중지되지 않으면 강제로 중지"

### 7단계: 저장 및 테스트
1. **확인**을 클릭하여 작업 저장
2. 작업 목록에서 `Stock Bot Monitor`를 찾아 마우스 오른쪽 버튼 클릭
3. **"실행"**을 선택하여 즉시 테스트

## 방법 2: 시작 프로그램 폴더 사용 (간단)

### 1단계: 시작 프로그램 폴더 열기
1. `Win + R` 키를 눌러 실행 창을 엽니다
2. `shell:startup`을 입력하고 Enter를 누릅니다

### 2단계: 바로가기 만들기
1. `start-monitor.bat` 파일의 바로가기를 만듭니다
2. 바로가기를 시작 프로그램 폴더에 복사합니다

> [!WARNING]
> 이 방법은 콘솔 창이 표시됩니다. 백그라운드에서 조용히 실행하려면 방법 1을 사용하세요.

## 모니터링 중지 방법

### 작업 스케줄러에서 중지
1. 작업 스케줄러 열기 (`taskschd.msc`)
2. `Stock Bot Monitor` 찾기
3. 마우스 오른쪽 버튼 → **"끝내기"** 또는 **"사용 안 함"**

### 작업 관리자에서 중지
1. `Ctrl + Shift + Esc`로 작업 관리자 열기
2. **세부 정보** 탭에서 `node.exe` 프로세스 찾기
3. 명령줄에 `monitor.js`가 포함된 프로세스 선택
4. **작업 끝내기** 클릭

## 로그 확인

모니터링 스크립트는 콘솔에 로그를 출력합니다. 로그를 파일로 저장하려면:

### PowerShell에서 실행 (로그 파일 저장)
```powershell
node scripts\monitor.js 2>&1 | Tee-Object -FilePath "logs\monitor.log"
```

## Discord 알림 확인

모니터링이 시작되면 Discord에 다음 알림이 전송됩니다:
- ▶️ **모니터링 시작** - 서비스가 시작될 때
- 🎯 **고점수 종목 발견** - 점수 80 이상 종목 발견 시
- ⚠️ **거래정지 종목 경고** - 거래정지 종목 발견 시
- 🟢/🔴/🟡 **AI 예측** - AI 분석 결과
- ⏸️ **모니터링 중지** - 서비스가 중지될 때

## 문제 해결

### Discord 알림이 오지 않는 경우
1. `.env.local` 파일에 `DISCORD_WEBHOOK_URL`이 설정되어 있는지 확인
2. Discord 웹훅 URL이 유효한지 확인
3. 콘솔 로그에서 오류 메시지 확인

### 모니터링이 시작되지 않는 경우
1. Node.js가 설치되어 있는지 확인 (`node --version`)
2. 의존성이 설치되어 있는지 확인 (`npm install`)
3. `.env.local` 파일이 존재하는지 확인
4. 작업 스케줄러에서 "마지막 실행 결과" 확인

### API 오류가 발생하는 경우
1. `.env.local`의 API 키가 올바른지 확인
2. 개발 서버가 실행 중인지 확인 (`npm run dev`)
3. 네트워크 연결 확인

## 추가 정보

- **체크 주기**: 1분마다
- **고점수 기준**: 80점 이상
- **알림 쿨다운**: 동일 종목 5분
- **API 호출 최적화**: 시간당 최대 60회
